{"id":"ISSUE-001","uuid":"6a41fb64-d043-415d-911d-76f2536795f4","title":"Server: Project Initialization & Basic Express Setup","description":"Set up the basic TypeScript + Express project structure for the sudocode backend server.\n\n## Tasks\n- [ ] Create `server/` directory structure\n- [ ] Initialize `package.json` with dependencies (express, typescript, etc.)\n- [ ] Create `tsconfig.json` for TypeScript configuration\n- [ ] Set up basic Express app in `src/index.ts`\n- [ ] Add development scripts (dev, build, start)\n- [ ] Create `.env.example` for environment variables\n- [ ] Create `.gitignore` with appropriate entries\n\n## Files to Create\n```\nserver/\n├── src/\n│   └── index.ts          # Basic Express app\n├── package.json\n├── tsconfig.json\n├── .env.example\n└── .gitignore\n```\n\n## Verification\n- Server should start on http://localhost:3001\n- GET http://localhost:3001/health should return 200\n- `npm run dev` should start the server successfully\n\n## Success Criteria\nExpress server that starts successfully with a health check endpoint.\n\nReference: [[server/server_plan.md]] - Phase 1, Step 1.1","content":"\n","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 09:53:37","updated_at":"2025-10-24 10:18:01","closed_at":"2025-10-24 10:18:01","parent_id":null,"relationships":[],"tags":["foundation","phase-1","server","setup"]}
{"id":"ISSUE-002","uuid":"326b22be-f823-4cf9-a281-c774cb6742cc","title":"Server: Database Setup & Schema Implementation","description":"Initialize SQLite database with schema for sudocode server.\n\n## Tasks\n- [ ] Create `src/services/db.ts` with database connection\n- [ ] Import schema from `../cli/src/schema.ts`\n- [ ] Add new tables for projects, issue_attempts, execution_processes\n- [ ] Add execution_process_logs table\n- [ ] Write database initialization function\n- [ ] Add database migration logic\n- [ ] Create helper functions for common queries\n\n## Files to Create\n```\nserver/src/\n├── services/\n│   └── db.ts             # Database connection & init\n└── types/\n    └── extended.ts       # Extended types (Project, IssueAttempt, etc.)\n```\n\n## Schema Additions\n- Projects table\n- Issue attempts table\n- Execution processes table\n- Execution process logs table\n\n## Verification\n- Run server with `npm run dev`\n- Database should be created at `server/sudocode.db`\n- All tables should be created successfully\n- Can query tables with sqlite3\n\n## Success Criteria\nWorking SQLite database with all required tables.\n\nReference: [[server/server_plan.md]] - Phase 1, Step 1.2","content":"\n","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 09:53:37","updated_at":"2025-10-24 10:18:01","closed_at":"2025-10-24 10:18:01","parent_id":null,"relationships":[],"tags":["database","phase-1","schema","server"]}
{"id":"ISSUE-003","uuid":"827d2fb6-ce4d-4889-a53f-d93688057825","title":"Server: Read Issues from JSONL","description":"Load and serve issues from issues.jsonl file.\n\n## Tasks\n- [ ] Create `src/services/jsonl.ts` for JSONL operations\n- [ ] Implement `readIssuesJsonl(path)` function\n- [ ] Implement `parseIssueJsonl(line)` function\n- [ ] Create `src/services/issues.ts` for issue business logic\n- [ ] Create `src/routes/issues.ts` for issue routes\n- [ ] Implement GET `/api/tasks` (list issues)\n- [ ] Implement GET `/api/tasks/:id` (get issue by ID)\n- [ ] Add request validation and error handling\n\n## Files to Create\n```\nserver/src/\n├── routes/\n│   └── issues.ts         # Issue routes (mapped to /tasks)\n└── services/\n    ├── jsonl.ts          # JSONL read/write operations\n    └── issues.ts         # Issue business logic\n```\n\n## JSONL Operations\n```typescript\nexport async function readIssuesJsonl(path: string): Promise<IssueJSONL[]>\nexport async function writeIssuesJsonl(path: string, issues: IssueJSONL[]): Promise<void>\nexport function parseJsonlLine<T>(line: string): T | null\n```\n\n## API Response Format\n```typescript\ninterface ApiResponse<T> {\n  success: boolean\n  data: T | null\n  error_data?: any\n  message?: string\n}\n```\n\n## Verification\n```bash\ncurl http://localhost:3002/api/tasks\n# Should return issues from .sudocode/issues.jsonl\n\ncurl http://localhost:3002/api/tasks/ISSUE-001\n# Should return specific issue\n```\n\n## Success Criteria\nRead-only issues API that loads from JSONL files.\n\nReference: [[server/server_plan.md]] - Phase 3, Step 3.1","content":"\n","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 10:09:13","updated_at":"2025-10-24 10:24:51","closed_at":"2025-10-24 10:24:51","parent_id":null,"relationships":[],"tags":["api","issues","phase-3","server"]}
{"id":"ISSUE-004","uuid":"ac4048e7-32c5-424f-a7c7-23dde7909c9c","title":"Server: Sync Issues to SQLite Cache","description":"Load JSONL data into SQLite for fast queries. The CLI already maintains the cache.db, so the server should read from the existing database.\n\n## Tasks\n- [ ] Update issues service to read from SQLite instead of JSONL\n- [ ] Implement `getIssues()` to query from database\n- [ ] Implement `getIssueById(id)` to query from database\n- [ ] Handle relationships and tags from database\n- [ ] Add indexes for common queries if not already present\n- [ ] Update GET endpoints to read from SQLite\n- [ ] Handle case when database is not synced (warn user)\n\n## Database Queries\n```typescript\nexport async function getIssues(filters?: IssueFilters): Promise<Issue[]>\nexport async function getIssueById(id: string): Promise<Issue | null>\nexport async function getIssueRelationships(id: string): Promise<Relationship[]>\nexport async function getIssueTags(id: string): Promise<string[]>\n```\n\n## Verification\n```bash\n# Ensure CLI has synced data first\nsudocode sync\n\n# Start server\nnpm run dev\n\n# Query via API\ncurl http://localhost:3002/api/tasks\n# Should return issues from SQLite\n\n# Check database directly\nsqlite3 .sudocode/cache.db \"SELECT COUNT(*) FROM issues;\"\n```\n\n## Success Criteria\nIssues loaded from SQLite cache maintained by CLI, with fast query performance.\n\nReference: [[server/server_plan.md]] - Phase 3, Step 3.2","content":"\n","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 10:09:14","updated_at":"2025-10-24 16:55:50","closed_at":"2025-10-24 16:55:50","parent_id":null,"relationships":[],"tags":["database","issues","phase-3","server"]}
{"id":"ISSUE-005","uuid":"68030861-d410-4baf-b1dc-36f486862c5a","title":"Server: Create & Update Issues via API","description":"Implement write operations for issues, delegating to CLI operations for JSONL consistency.\n\n## Tasks\n- [ ] Implement POST `/api/tasks` (create issue)\n- [ ] Implement PUT `/api/tasks/:id` (update issue)\n- [ ] Use CLI operations from `@sudocode/cli` for consistency\n- [ ] Add request validation with Zod schemas\n- [ ] Handle validation errors gracefully\n- [ ] Return updated issue in response\n- [ ] Trigger sync after write operations\n\n## Integration with CLI\n```typescript\nimport { createIssue, updateIssue } from '@sudocode/cli/operations/issues'\n\nexport async function createIssueService(data: CreateIssueRequest): Promise<Issue> {\n  // Use CLI operation to create in JSONL\n  const issue = await createIssue(db, data)\n  \n  // CLI handles JSONL and SQLite sync\n  return issue\n}\n```\n\n## Request Validation\n```typescript\nconst createIssueSchema = z.object({\n  title: z.string().min(1).max(500),\n  description: z.string(),\n  status: z.enum(['open', 'in_progress', 'blocked', 'needs_review', 'closed']),\n  priority: z.number().min(0).max(4).optional(),\n  assignee: z.string().optional(),\n  tags: z.array(z.string()).optional(),\n})\n```\n\n## Verification\n```bash\n# Create new issue\ncurl -X POST http://localhost:3002/api/tasks \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"title\": \"Test Issue\", \"description\": \"Test\", \"status\": \"open\"}'\n\n# Update issue\ncurl -X PUT http://localhost:3002/api/tasks/ISSUE-001 \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"status\": \"in_progress\"}'\n\n# Check issues.jsonl updated\ncat .sudocode/issues.jsonl | tail -1\n```\n\n## Success Criteria\nFull create and update operations for issues with JSONL persistence via CLI.\n\nReference: [[server/server_plan.md]] - Phase 3, Step 3.3","content":"\n","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 10:09:14","updated_at":"2025-10-24 17:23:50","closed_at":"2025-10-24 17:23:50","parent_id":null,"relationships":[],"tags":["api","crud","issues","phase-3","server"]}
{"id":"ISSUE-006","uuid":"5952bd3f-1731-4aa9-9ee0-3023570b8c75","title":"Server: Delete Issues via API","description":"Implement issue deletion with proper cascade handling.\n\n## Tasks\n- [ ] Implement DELETE `/api/tasks/:id`\n- [ ] Use CLI delete operation for consistency\n- [ ] Handle cascade deletion of relationships and tags\n- [ ] Add soft delete option (status='closed') as alternative\n- [ ] Return success response with deleted issue ID\n- [ ] Add confirmation requirement for destructive operations\n\n## Delete Operations\n```typescript\nexport async function deleteIssueService(id: string, soft: boolean = false): Promise<void> {\n  if (soft) {\n    // Soft delete: just close the issue\n    await updateIssue(db, id, { status: 'closed', closed_at: new Date().toISOString() })\n  } else {\n    // Hard delete: remove from JSONL and database\n    await deleteIssue(db, id)\n  }\n}\n```\n\n## API Design\n```typescript\n// Hard delete\nDELETE /api/tasks/:id\n\n// Soft delete (close)\nPUT /api/tasks/:id\n{ \"status\": \"closed\" }\n```\n\n## Verification\n```bash\n# Soft delete (close issue)\ncurl -X PUT http://localhost:3002/api/tasks/ISSUE-001 \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"status\": \"closed\"}'\n\n# Hard delete\ncurl -X DELETE http://localhost:3002/api/tasks/ISSUE-001\n\n# Verify removed from JSONL and SQLite\ncat .sudocode/issues.jsonl | grep ISSUE-001\n# Should return nothing\n\nsqlite3 .sudocode/cache.db \"SELECT * FROM issues WHERE id='ISSUE-001';\"\n# Should return nothing\n```\n\n## Success Criteria\nComplete CRUD operations for issues with both hard and soft delete options.\n\nReference: [[server/server_plan.md]] - Phase 3, Step 3.4","content":"\n","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 10:09:14","updated_at":"2025-10-24 17:33:04","closed_at":"2025-10-24 17:33:04","parent_id":null,"relationships":[],"tags":["api","crud","issues","phase-3","server"]}
{"id":"ISSUE-007","uuid":"bff23a82-fea5-45e4-8519-ef2b01c1004c","title":"Server: Read Specs from JSONL","description":"Load and serve specs from specs.jsonl file, following the same pattern as the Issues API.\n\n## Tasks\n- [ ] Create `src/routes/specs.ts` for spec routes\n- [ ] Create `src/services/specs.ts` wrapping CLI operations\n- [ ] Implement GET `/api/specs` (list specs)\n- [ ] Implement GET `/api/specs/:id` (get spec by ID)\n- [ ] Use CLI operations from `@sudocode/cli` for consistency\n- [ ] Support filtering and pagination\n- [ ] Include relationships in response\n\n## Files to Create\n```\nserver/src/\n├── routes/\n│   └── specs.ts         # Spec routes (mapped to /api/specs)\n└── services/\n    └── specs.ts         # Spec business logic (wraps CLI)\n```\n\n## Integration with CLI\n```typescript\nimport { getSpec, listSpecs } from '@sudocode/cli/dist/operations/index.js'\n\nexport function getAllSpecs(db: Database.Database, options?: ListSpecsOptions): Spec[] {\n  return listSpecs(db, options || {})\n}\n\nexport function getSpecById(db: Database.Database, id: string): Spec | null {\n  return getSpec(db, id)\n}\n```\n\n## API Response Format\nSame as issues API:\n```typescript\ninterface ApiResponse<T> {\n  success: boolean\n  data: T | null\n  error_data?: any\n  message?: string\n}\n```\n\n## Verification\n```bash\ncurl http://localhost:3002/api/specs\n# Should return specs from SQLite\n\ncurl http://localhost:3002/api/specs/SPEC-001\n# Should return specific spec\n```\n\n## Success Criteria\nRead-only specs API that delegates to CLI operations, following the same patterns as Issues API.\n\nReference: [[server/server_plan.md]] - Phase 4, Step 4.1","content":"","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 17:50:33","updated_at":"2025-10-24 18:04:49","closed_at":"2025-10-24 18:04:49","parent_id":null,"relationships":[],"tags":[]}
{"id":"ISSUE-008","uuid":"eccab6c9-845c-4271-9c2e-f436ec4247e7","title":"Server: Specs CRUD Operations","description":"Implement full create, update, and delete operations for specs via API.\n\n## Tasks\n- [ ] Implement POST `/api/specs` (create spec)\n- [ ] Implement PUT `/api/specs/:id` (update spec)\n- [ ] Implement DELETE `/api/specs/:id` (delete spec)\n- [ ] Use CLI operations from `@sudocode/cli` for consistency\n- [ ] Add request validation\n- [ ] Handle validation errors gracefully\n- [ ] Return created/updated spec in response\n- [ ] Add comprehensive tests for all CRUD operations\n\n## Integration with CLI\n```typescript\nimport { createSpec, updateSpec, deleteSpec } from '@sudocode/cli/dist/operations/index.js'\n\nexport function createNewSpec(db: Database.Database, input: CreateSpecInput): Spec {\n  return createSpec(db, input)\n}\n\nexport function updateExistingSpec(db: Database.Database, id: string, input: UpdateSpecInput): Spec {\n  return updateSpec(db, id, input)\n}\n\nexport function deleteExistingSpec(db: Database.Database, id: string): boolean {\n  return deleteSpec(db, id)\n}\n```\n\n## Request Validation\n- Title: required, max 500 characters\n- Content: optional markdown content\n- Priority: 0-4, default 2\n- Parent ID: optional, must exist if provided\n\n## Verification\n```bash\n# Create new spec\ncurl -X POST http://localhost:3002/api/specs \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\"title\": \"Test Spec\", \"content\": \"# Spec content\"}'\n\n# Update spec\ncurl -X PUT http://localhost:3002/api/specs/SPEC-001 \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\"content\": \"# Updated content\"}'\n\n# Delete spec\ncurl -X DELETE http://localhost:3002/api/specs/SPEC-001\n\n# Run tests\nnpm test\n```\n\n## Success Criteria\nFull CRUD operations for specs with CLI delegation and comprehensive test coverage.\n\nReference: [[server/server_plan.md]] - Phase 4, Step 4.2","content":"","status":"closed","priority":0,"assignee":null,"created_at":"2025-10-24 17:50:34","updated_at":"2025-10-24 18:13:32","closed_at":"2025-10-24 18:13:32","parent_id":null,"relationships":[],"tags":[]}
